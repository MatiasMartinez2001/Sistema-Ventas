<div class="container my-5">
  <div class="row mb-4">
    <div class="col-12">
      <h1 class="mb-3">Gesti√≥n de Productos</h1>
      <button 
        class="btn btn-primary" 
        (click)="toggleFormulario()"
        type="button">
        {{ mostrarFormulario ? 'Cancelar' : '+ Agregar Producto' }}
      </button>
    </div>
  </div>

  <!-- Formulario para agregar producto -->
  <div class="row mb-4" *ngIf="mostrarFormulario">
    <div class="col-12">
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0">Nuevo Producto</h5>
        </div>
        <div class="card-body">
          <form [formGroup]="formularioProducto" (ngSubmit)="onSubmit()">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="nombre" class="form-label">Nombre <span class="text-danger">*</span></label>
                <input 
                  type="text" 
                  class="form-control" 
                  id="nombre"
                  formControlName="nombre"
                  [class.is-invalid]="formularioProducto.get('nombre')?.invalid && formularioProducto.get('nombre')?.touched">
                <div class="invalid-feedback" *ngIf="getFieldError('nombre')">
                  {{ getFieldError('nombre') }}
                </div>
              </div>

              <div class="col-md-6 mb-3">
                <label for="categoria" class="form-label">Categor√≠a</label>
                <input 
                  type="text" 
                  class="form-control" 
                  id="categoria"
                  formControlName="categoria"
                  placeholder="Ej: Maquillaje, Cuidado de la Piel, Fragancias">
              </div>
            </div>

            <div class="row">
              <div class="col-12 mb-3">
                <label for="descripcion" class="form-label">Descripci√≥n <span class="text-danger">*</span></label>
                <textarea 
                  class="form-control" 
                  id="descripcion"
                  formControlName="descripcion"
                  rows="3"
                  [class.is-invalid]="formularioProducto.get('descripcion')?.invalid && formularioProducto.get('descripcion')?.touched"></textarea>
                <div class="invalid-feedback" *ngIf="getFieldError('descripcion')">
                  {{ getFieldError('descripcion') }}
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="precio" class="form-label">Precio <span class="text-danger">*</span></label>
                <div class="input-group">
                  <span class="input-group-text">$</span>
                  <input 
                    type="number" 
                    step="0.01"
                    class="form-control" 
                    id="precio"
                    formControlName="precio"
                    [class.is-invalid]="formularioProducto.get('precio')?.invalid && formularioProducto.get('precio')?.touched">
                  <div class="invalid-feedback" *ngIf="getFieldError('precio')">
                    {{ getFieldError('precio') }}
                  </div>
                </div>
              </div>

              <div class="col-md-6 mb-3">
                <label for="stock" class="form-label">Stock <span class="text-danger">*</span></label>
                <input 
                  type="number" 
                  class="form-control" 
                  id="stock"
                  formControlName="stock"
                  [class.is-invalid]="formularioProducto.get('stock')?.invalid && formularioProducto.get('stock')?.touched">
                <div class="invalid-feedback" *ngIf="getFieldError('stock')">
                  {{ getFieldError('stock') }}
                </div>
              </div>
            </div>

            <div class="d-flex gap-2">
              <button 
                type="submit" 
                class="btn btn-success"
                [disabled]="formularioProducto.invalid">
                Guardar Producto
              </button>
              <button 
                type="button" 
                class="btn btn-secondary"
                (click)="toggleFormulario()">
                Cancelar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Lista de productos -->
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header bg-light">
          <h5 class="mb-0">Cat√°logo de Productos ({{ productos().length }})</h5>
        </div>
        <div class="card-body">
          <div *ngIf="productos().length === 0" class="alert alert-info">
            No hay productos registrados. Agrega tu primer producto usando el bot√≥n de arriba.
          </div>

          <div class="table-responsive" *ngIf="productos().length > 0">
            <table class="table table-striped table-hover">
              <thead class="table-dark">
                <tr>
                  <th>Nombre</th>
                  <th>Descripci√≥n</th>
                  <th>Categor√≠a</th>
                  <th>Precio</th>
                  <th>Stock</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let producto of productos()">
                  <td><strong>{{ producto.nombre }}</strong></td>
                  <td>{{ producto.descripcion }}</td>
                  <td>
                    <span class="badge bg-secondary">{{ producto.categoria || 'Sin categor√≠a' }}</span>
                  </td>
                  <td>{{ formatearPrecio(producto.precio) }}</td>
                  <td>
                    <span [class]="producto.stock < 10 ? 'badge bg-warning' : 'badge bg-success'">
                      {{ producto.stock }}
                    </span>
                  </td>
                  <td>
                    <button 
                      class="btn btn-danger btn-sm"
                      (click)="eliminarProducto(producto.id)"
                      title="Eliminar producto">
                      üóëÔ∏è Eliminar
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
